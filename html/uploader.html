<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Uploader</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" />
    <link rel="stylesheet" href="../css/loading.css" />
    <link rel="stylesheet" href="../css/uploader.css" />
</head>

<body>
    <div id="app" v-cloak>
        <h1>Uploader</h1>
        <el-form ref="form" :model="form" :rules="rules" label-width="120px" v-show="loading">
            <el-form-item label="作成者" prop="creator">
                <el-input 
                maxlength="30"
                show-word-limit
                v-model="form.creator">
                    <el-button slot="prepend" icon="el-icon-user-solid"></el-button>
                </el-input>
            </el-form-item>
            <br />

            <el-form-item label="課題名" prop="prob_name">
                <el-input 
                maxlength="30"
                show-word-limit
                v-model="form.prob_name">
                    <el-button slot="prepend" icon="el-icon-question"></el-button>
                </el-input>
            </el-form-item>
            <br />

            <el-form-item label="傾斜">
                <el-select v-model="form.select_wall" placeholder="傾斜を選択してください">
                    <el-option v-for="wall in walls" v-bind:value="wall.category" v-bind:key="wall.id">
                        {{ wall.category }}
                    </el-option>
                </el-select>
            </el-form-item>
            <br />

            <el-form-item label="グレード">
                <el-select v-model="form.select_grade" placeholder="グレードを選択してください">
                    <el-option v-for="grade in grades" v-bind:value="grade.grade" v-bind:key="grade.id">
                        {{ grade.grade }}
                    </el-option>
                    <el-button slot="append" icon="el-icon-search"></el-button>
                </el-select>
            </el-form-item>
            <br />

            <el-form-item label="課題">
                <el-upload class="problem-uploader" action="https://jsonplaceholder.typicode.com/posts/"
                    :show-file-list="false" 
                    :thumbnail-mode="true"
                    :on-success="handleProblemSuccess" 
                    :before-upload="beforeProblemUpload" >
                    <img v-if="imageUrl" :src="imageUrl" class="problem" />
                    <i v-else class="el-icon-plus problem-uploader-icon"></i>
                </el-upload>
            </el-form-item>
            <br />

            <el-form-item label="LINE通知">
                <el-switch v-model="form.line_notif">
                </el-switch>
            </el-form-item>
            <br />

            <el-form-item>
                <el-button type="primary" @click="dialogVisible = true">登録</el-button>
                <el-button @click="resetForm('form')">クリア</el-button>
            </el-form-item>
        </el-form>

        <el-dialog title="登録前の確認" :visible.sync="dialogVisible" width="100%" :before-close="handleClose" v-cloak>
            <span>この内容で登録しますか？</span>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dialogVisible = false">キャンセル</el-button>
                <el-button type="primary" @click="submitForm('form'); dialogVisible = false;">OK</el-button>
            </span>
        </el-dialog>
    </div>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/element-ui/lib/umd/locale/ja.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="../js/uploader.js"></script>
</body>
</html>